# Raspberry PI IP Cam (PIPCam)
組込AI研究所（Embed AI Labo）  
このプログラムはラズベリーパイをIPカメラ化するプログラムです。
開発にあたり、USBカメラを開く際デバイス/dev/video0を開くところで停止することが分かりました。  
おそらく、Flaskを使ったプログラムがマルチスレッドで動くことによりデバイスの取り合いが発生したものと思います。  
これを回避するために、本プログラムではカメラの画像情報を読取約１秒間に10個のファイルを作り同一ファイルの書き込み最中の映像を読取しないようにMotion Jpeg Stream配信部分で２秒後のファイルを配信するようにしいます。  
ラズパイZeroでは処理が遅いために十分時間を取る必要がありますが３B＋や４B＋ではもっと短くすることができると思いますので調整してみてください。  

前提条件としてラズベリーパイのPython3環境にOpenCVと配信用にFlaskが必要です。
特にラズベリーパイ環境ではなくても動作はすると思います。中古パソコンにLinuxを入れても動作可能なので中古PCのIPカメラ化が可能でしょう。
もう一つ前提条件としてX-Windowが動作している必要があります。  
  
この前提条件下で以下のスクリプトを起動すると動作します。  
  
./start  
  
終わる場合は、X-Window画面でカメラ映像ウインドウをアクティブにしてqキーを押すと画像の読取り部が終了しますので、startプログラムの起動した端末で[ctrl]+Cを押して終了します。  
